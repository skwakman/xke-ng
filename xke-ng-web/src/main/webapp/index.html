<!DOCTYPE html> 
<html> 
	<head> 
	<title>Status.net</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.css" />
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.js"></script>
</head> 

<script type="text/javascript">

	$(document).ready(
		$("#next").live("pageshow",
                                function(event, ui) {
									$.ajax({
										type: 'GET',
										dataType: 'json',
										contentType: 'application/json',
										url: '/xkeng/conference/next',
										success: conferenceSuccessCallback,
										crossDomain: false,
										error: function (xhr, ajaxOptions, thrownError) {
							                    alert("Unable to get conferences\nCode " + xhr.status + "\nMessage " + xhr.status);
										}
									})
                                })

	);

/*
	function updateCallback(response) {
		$.mobile.hidePageLoadingMsg();
		console.log("update was POST-ed")
		$("#update-list").children().remove();
		$("#update-list").listview("refresh");
		$("#statusUpdateField").val("")
		getHomeTimeline();
	}
*/

/*
	function homeTimeLineCallback(response){
		console.log("callback called");
		
		for (updateIndex in response) {
		var update = response[updateIndex]
			$("#update-list").append("<li><i>" + update.user.screen_name + "</i><br><br>" + update.text + "</li>")
		}
		$("#update-list").listview("refresh");
		
		console.log(response)
	}
*/
	
	function login() {
		var jsonRequest = {}
		jsonRequest.username = $("#username").val();;
		jsonRequest.password = $("#password").val();;

		$.ajax({
			type: 'POST',
			dataType: 'json',
			contentType: 'application/json',
			url: '/xkeng/login',
			success: loginSuccessCallback,
			crossDomain: false,
			data: JSON.stringify(jsonRequest),
			error: function (xhr, ajaxOptions, thrownError){
                    alert("Unable to post login\nCode " + xhr.status + "\nMessage " + xhr.status);
			}
		});
	}
	
	function loginSuccessCallback(response) {
		$.mobile.changePage( "#next", { transition: "slidedown"} );
 	}
 	var currentSessionId;
	function changeToSessionDetailsPage(id) {
		currentSessionId = id;
		$.mobile.changePage( "#detail", { transition: "slidedown"} );
	}
	
 	
 	function conferenceSuccessCallback(response) {
 	
	 	console.log(response)
 	
		for (sessionsIndex in response.sessions) {
			var session = response.sessions[sessionsIndex]
			
			$("#next-list").append("<li><a href='javascript:changeToSessionDetailsPage(\"" + session.id + "\");'><i>" + session.description + "</i><br><br>" + session.location.description + "</a></li>")
		}
		$("#next-list").listview("refresh"); 	
 	}

</script>

<body>


	<div data-role="page" id="login">
	
		<div data-role="header">
			<h1>Login</h1>
		</div>
		
	
		<div data-role="content">	
            <form action="javascript: login();">
                <input id="username" type="text" placeholder="Your username"/>
                <input id="password" type="password" placeholder="Your password"/>
                <button type="submit">Login</button>
            </form>
		</div>
	</div>

	<div data-role="page" id="next">
	
		<div data-role="header">
			<h1>Current XKE</h1>
		</div>
		
	
		<div data-role="content">	
			<ul id="next-list" data-role="listview" data-filter="true"/>
		</div>
		
		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
				<ul>
					<li><a href="#current" class="ui-btn-active">Current</a></li>
					<li><a href="#next">Next</a></li>
				</ul>
			</div>	
		</div>	
	</div>
	
	<div data-role="page" id="upcomming">
	
		<div data-role="header">
			<h1>Current</h1>
		</div>
		
	
		<div data-role="content">	
            <form action="#">
                <input id="statusUpdateField" type="text" name="resource" placeholder="What are you thinking about" onchange="#"/>
            </form>
            <br>
			<ul id="update-list" data-role="listview" data-filter="true">
			</ul>

		</div>
		
		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
				<ul>
					<li><a href="#current">Current</a></li>
					<li><a href="#next" class="ui-btn-active">Next</a></li>
				</ul>
			</div>	
		</div>
	</div>


	<div data-role="page" id="detail">
	
		<div data-role="header" >
			<h1 id="detailHeader">Session</h1>
		</div>
		
	
		<div data-role="content">	
			<ul id="next-list" data-role="listview" data-filter="true"/>
		</div>
		
		<div data-role="footer" data-position="fixed">
			<div data-role="navbar">
				<ul>
					<li><a href="#current" class="ui-btn-active">Current</a></li>
					<li><a href="#next">Next</a></li>
				</ul>
			</div>	
		</div>	
	</div>
</body>

</html>

